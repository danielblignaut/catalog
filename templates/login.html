
{% extends "base.html" %}
{% block body %}
	<div class="g-signin2" data-onsuccess="onSignIn"></div>
{% endblock %}

{% block javascript %}
 <script>
      function onSignIn(googleUser) {
        var profile = googleUser.getBasicProfile();
        if(profile) {
          $('.g-signin2').css('display', 'none');

          $.ajax({
            type: 'POST',
            url: '/json/gconnect?state={{state}}',
            contentType: "application/json",
            data: JSON.stringify(googleUser.getAuthResponse().id_token),
            success: function(result) {
              if(result) {
                $('#result').html('<p>Login Successful, redirecting...</p>');
                setTimeout(function() {
                  window.location.href = "/";
                }, 1000);
              }
              else {
                $('#result').html('<p>There was an error making server side calls</p>');
              }
            }
          })
        }
      }


    </script>
{% endblock %}
